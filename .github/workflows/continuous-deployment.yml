name: Continuous Deployment Pipeline

on:
  push:
    branches:
      - master

jobs:
  deploy_all:
    strategy:
      matrix:
        sub_environment_name:
          [internal-dev, internal-dev-sandbox, sandbox, ref, int]
    uses: ./.github/workflows/deploy-backend.yml
    with:
      apigee_environment: ${{ matrix.sub_environment_name }}
      create_mns_subscription: true
      environment: dev
      sub_environment: ${{ matrix.sub_environment_name }}
