{"uid":"f27ae0f69147c34a","name":"Verify that the /status endpoint works","fullName":"features.APITests.steps.test_status_steps#test_verify_that_the_status_endpoint_works","historyId":"1ef0d2406e3b365c7228b10d2a2c4b77","time":{"start":1768931233501,"stop":1768931233502,"duration":1},"description":"/home/runner/work/immunisation-fhir-api/immunisation-fhir-api/tests/e2e_automation/features/APITests/status.feature: Verify that the /status endpoint works","descriptionHtml":"<p>/home/runner/work/immunisation-fhir-api/immunisation-fhir-api/tests/e2e_automation/features/APITests/status.feature: Verify that the /status endpoint works</p>\n","status":"broken","statusMessage":"OSError: APIGEE_ACCESS_TOKEN environment variable is required","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the /ping endpoint works', ScenarioTemplate(feature=..., keyw... datatable=None, failed=False, scenario=None, background=None)], description='', tags={'sandbox', 'smoke'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert not self.is_historic(), (\n            \"Cannot directly call a historic hook - use call_historic instead.\"\n        )\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_hooks.py:512: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:120: in pytest_bdd_after_scenario\n    context = request.getfixturevalue(\"context\")\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1047: in execute\n    fixturedef = request._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:891: in call_fixture_func\n    fixture_result = next(generator)\nfeatures/conftest.py:62: in temp_apigee_apps\n    apigee_app_mgr = ApigeeOnDemandAppManager()\nutilities/apigee/ApigeeOnDemandAppManager.py:36: in __init__\n    self.access_token = get_apigee_access_token()\nutilities/apigee/apigee_env_helpers.py:47: in get_apigee_access_token\n    return get_env_var(\"APIGEE_ACCESS_TOKEN\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nvar_name = 'APIGEE_ACCESS_TOKEN'\n\n    def get_env_var(var_name: str) -> str:\n        value = os.getenv(var_name)\n    \n        if not value:\n>           raise EnvironmentError(f\"{var_name} environment variable is required\")\nE           OSError: APIGEE_ACCESS_TOKEN environment variable is required\n\nutilities/apigee/apigee_env_helpers.py:11: OSError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"setup_environment","time":{"start":1768931228709,"stop":1768931228710,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_context","time":{"start":1768931228714,"stop":1768931233332,"duration":4618},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pytest_bdd_example","time":{"start":1768931233501,"stop":1768931233501,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"/home/runner/work/immunisation-fhir-api/immunisation-fhir-api/tests/e2e_automation/features/APITests/status.feature: Verify that the /status endpoint works","status":"broken","statusMessage":"OSError: APIGEE_ACCESS_TOKEN environment variable is required","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the /ping endpoint works', ScenarioTemplate(feature=..., keyw... datatable=None, failed=False, scenario=None, background=None)], description='', tags={'sandbox', 'smoke'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert not self.is_historic(), (\n            \"Cannot directly call a historic hook - use call_historic instead.\"\n        )\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_hooks.py:512: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:120: in pytest_bdd_after_scenario\n    context = request.getfixturevalue(\"context\")\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1047: in execute\n    fixturedef = request._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:891: in call_fixture_func\n    fixture_result = next(generator)\nfeatures/conftest.py:62: in temp_apigee_apps\n    apigee_app_mgr = ApigeeOnDemandAppManager()\nutilities/apigee/ApigeeOnDemandAppManager.py:36: in __init__\n    self.access_token = get_apigee_access_token()\nutilities/apigee/apigee_env_helpers.py:47: in get_apigee_access_token\n    return get_env_var(\"APIGEE_ACCESS_TOKEN\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nvar_name = 'APIGEE_ACCESS_TOKEN'\n\n    def get_env_var(var_name: str) -> str:\n        value = os.getenv(var_name)\n    \n        if not value:\n>           raise EnvironmentError(f\"{var_name} environment variable is required\")\nE           OSError: APIGEE_ACCESS_TOKEN environment variable is required\n\nutilities/apigee/apigee_env_helpers.py:11: OSError","steps":[],"attachments":[{"uid":"3192dcb5ca88dabf","name":"Step Failed: I send a request to the status endpoint","source":"3192dcb5ca88dabf.txt","type":"text/plain","size":122}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"epic","value":"Immunization Service"},{"name":"suite","value":"Get the API status"},{"name":"feature","value":"Get the API status"},{"name":"tag","value":"functional"},{"name":"tag","value":"sandbox"},{"name":"tag","value":"smoke"},{"name":"tag","value":"Status_feature"},{"name":"parentSuite","value":"features.APITests.steps"},{"name":"host","value":"runnervmmtnos"},{"name":"thread","value":"2709-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"features.APITests.steps.test_status_steps"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":4,"unknown":0,"total":5},"items":[{"uid":"fa262aff482df7d0","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1113/#testresult/fa262aff482df7d0","status":"passed","time":{"start":1768929948481,"stop":1768929948674,"duration":193}},{"uid":"b9548a1a50b909b4","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1113/#testresult/b9548a1a50b909b4","status":"passed","time":{"start":1768930003261,"stop":1768930003445,"duration":184}},{"uid":"c977a5897eba1298","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1111/#testresult/c977a5897eba1298","status":"passed","time":{"start":1768906322405,"stop":1768906323549,"duration":1144}},{"uid":"a301e7ec7d6c9a2a","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1111/#testresult/a301e7ec7d6c9a2a","status":"passed","time":{"start":1768906402090,"stop":1768906402310,"duration":220}}]},"tags":["Status_feature","functional","sandbox","smoke"]},"source":"f27ae0f69147c34a.json","parameterValues":[]}