{"uid":"701e44f16a96862d","name":"Verify that the /ping endpoint works","fullName":"features.APITests.steps.test_status_steps#test_verify_that_the_ping_endpoint_works","historyId":"d34375dfd9c8e725ce7e18dd791c3503","time":{"start":1768931228710,"stop":1768931233333,"duration":4623},"description":"/home/runner/work/immunisation-fhir-api/immunisation-fhir-api/tests/e2e_automation/features/APITests/status.feature: Verify that the /ping endpoint works","descriptionHtml":"<p>/home/runner/work/immunisation-fhir-api/immunisation-fhir-api/tests/e2e_automation/features/APITests/status.feature: Verify that the /ping endpoint works</p>\n","status":"broken","statusMessage":"OSError: APIGEE_ACCESS_TOKEN environment variable is required","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the /ping endpoint works', ScenarioTemplate(feature=..., keyw... datatable=None, failed=False, scenario=None, background=None)], description='', tags={'sandbox', 'smoke'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert not self.is_historic(), (\n            \"Cannot directly call a historic hook - use call_historic instead.\"\n        )\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_hooks.py:512: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:120: in pytest_bdd_after_scenario\n    context = request.getfixturevalue(\"context\")\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1047: in execute\n    fixturedef = request._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:891: in call_fixture_func\n    fixture_result = next(generator)\nfeatures/conftest.py:62: in temp_apigee_apps\n    apigee_app_mgr = ApigeeOnDemandAppManager()\nutilities/apigee/ApigeeOnDemandAppManager.py:36: in __init__\n    self.access_token = get_apigee_access_token()\nutilities/apigee/apigee_env_helpers.py:47: in get_apigee_access_token\n    return get_env_var(\"APIGEE_ACCESS_TOKEN\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nvar_name = 'APIGEE_ACCESS_TOKEN'\n\n    def get_env_var(var_name: str) -> str:\n        value = os.getenv(var_name)\n    \n        if not value:\n>           raise EnvironmentError(f\"{var_name} environment variable is required\")\nE           OSError: APIGEE_ACCESS_TOKEN environment variable is required\n\nutilities/apigee/apigee_env_helpers.py:11: OSError","flaky":false,"newFailed":false,"newBroken":true,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"setup_environment","time":{"start":1768931228709,"stop":1768931228710,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pytest_bdd_example","time":{"start":1768931228710,"stop":1768931228710,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"global_context","time":{"start":1768931228714,"stop":1768931233332,"duration":4618},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"/home/runner/work/immunisation-fhir-api/immunisation-fhir-api/tests/e2e_automation/features/APITests/status.feature: Verify that the /ping endpoint works","status":"broken","statusMessage":"OSError: APIGEE_ACCESS_TOKEN environment variable is required","statusTrace":"self = <HookCaller 'pytest_bdd_after_scenario'>\nkwargs = {'feature': Feature(scenarios=OrderedDict([('Verify that the /ping endpoint works', ScenarioTemplate(feature=..., keyw... datatable=None, failed=False, scenario=None, background=None)], description='', tags={'sandbox', 'smoke'}, rule=None)}\nfirstresult = False\n\n    def __call__(self, **kwargs: object) -> Any:\n        \"\"\"Call the hook.\n    \n        Only accepts keyword arguments, which should match the hook\n        specification.\n    \n        Returns the result(s) of calling all registered plugins, see\n        :ref:`calling`.\n        \"\"\"\n        assert not self.is_historic(), (\n            \"Cannot directly call a historic hook - use call_historic instead.\"\n        )\n        self._verify_all_args_are_provided(kwargs)\n        firstresult = self.spec.opts.get(\"firstresult\", False) if self.spec else False\n        # Copy because plugins may register other plugins during iteration (#438).\n>       return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)\n\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_hooks.py:512: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/pluggy/_manager.py:120: in _hookexec\n    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)\nfeatures/conftest.py:120: in pytest_bdd_after_scenario\n    context = request.getfixturevalue(\"context\")\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:532: in getfixturevalue\n    fixturedef = self._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1047: in execute\n    fixturedef = request._get_active_fixturedef(argname)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:617: in _get_active_fixturedef\n    fixturedef.execute(request=subrequest)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1071: in execute\n    raise exc.with_traceback(exc_tb)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:1140: in pytest_fixture_setup\n    result = call_fixture_func(fixturefunc, request, kwargs)\n/home/runner/.cache/pypoetry/virtualenvs/e2e-automation-vB3pK5nq-py3.11/lib/python3.11/site-packages/_pytest/fixtures.py:891: in call_fixture_func\n    fixture_result = next(generator)\nfeatures/conftest.py:62: in temp_apigee_apps\n    apigee_app_mgr = ApigeeOnDemandAppManager()\nutilities/apigee/ApigeeOnDemandAppManager.py:36: in __init__\n    self.access_token = get_apigee_access_token()\nutilities/apigee/apigee_env_helpers.py:47: in get_apigee_access_token\n    return get_env_var(\"APIGEE_ACCESS_TOKEN\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nvar_name = 'APIGEE_ACCESS_TOKEN'\n\n    def get_env_var(var_name: str) -> str:\n        value = os.getenv(var_name)\n    \n        if not value:\n>           raise EnvironmentError(f\"{var_name} environment variable is required\")\nE           OSError: APIGEE_ACCESS_TOKEN environment variable is required\n\nutilities/apigee/apigee_env_helpers.py:11: OSError","steps":[],"attachments":[{"uid":"dcd966fd96dbeb4f","name":"Step Failed: I send a request to the ping endpoint","source":"dcd966fd96dbeb4f.txt","type":"text/plain","size":120},{"uid":"caa32c3f510e258c","name":"log","source":"caa32c3f510e258c.txt","type":"text/plain","size":93},{"uid":"4d9ace6652b6ab24","name":"stdout","source":"4d9ace6652b6ab24.txt","type":"text/plain","size":21}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":3,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"epic","value":"Immunization Service"},{"name":"suite","value":"Get the API status"},{"name":"feature","value":"Get the API status"},{"name":"tag","value":"functional"},{"name":"tag","value":"sandbox"},{"name":"tag","value":"smoke"},{"name":"tag","value":"Status_feature"},{"name":"parentSuite","value":"features.APITests.steps"},{"name":"host","value":"runnervmmtnos"},{"name":"thread","value":"2709-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"features.APITests.steps.test_status_steps"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"history":{"statistic":{"failed":0,"broken":1,"skipped":0,"passed":4,"unknown":0,"total":5},"items":[{"uid":"9ae73044e4fdcdbc","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1113/#testresult/9ae73044e4fdcdbc","status":"passed","time":{"start":1768929948380,"stop":1768929948479,"duration":99}},{"uid":"8a3011d137236d7","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1113/#testresult/8a3011d137236d7","status":"passed","time":{"start":1768929994371,"stop":1768930003253,"duration":8882}},{"uid":"325a32c2f3317f8b","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1111/#testresult/325a32c2f3317f8b","status":"passed","time":{"start":1768906322285,"stop":1768906322403,"duration":118}},{"uid":"f7b6c404c5fd3179","reportUrl":"https://NHSDigital.github.io/immunisation-fhir-api/1111/#testresult/f7b6c404c5fd3179","status":"passed","time":{"start":1768906392147,"stop":1768906402084,"duration":9937}}]},"tags":["Status_feature","functional","sandbox","smoke"]},"source":"701e44f16a96862d.json","parameterValues":[]}